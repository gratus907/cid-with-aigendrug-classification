import torch
from torch.utils.data import Dataset, DataLoader
from sklearn.model_selection import train_test_split
import numpy as np
from torchvision.transforms import transforms
from rdkit import Chem
import networkx as nx
import sys, io
import csv

def parse_input(filename):
    f = open(filename, 'r')
    lines = f.readlines()
    smiles = []
    for line in lines:
        smile = line.strip()
        if len(smile) == 0: continue
        smiles.append(smile)
    return smiles


WEIGHT = np.array([  5.8496,   5.4226,   3.3921,   1.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   5.7912,   5.9089,   5.6264,   5.3318,   1.0000,
          5.3165,   7.1750,   4.6855,  -8.6250,   5.5562,   5.6259,   4.6467,
          1.0000,  -8.6250,  15.2725,  13.7851,   7.3697,  10.0000,   0.0000,
        -10.0000, -10.0000,  15.8496,   5.8496,   0.0000,  11.0852,   5.3605,
         -3.2193,  -5.8496,  10.8342,   4.8543,   1.0000,   0.0000, -10.0000,
          0.0000,  21.1548,  23.2193,   0.0000,   1.0000,  -5.8496,   1.0000,
          0.0000,   0.0000, -10.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
        -10.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   8.6250,  15.0250,  15.8496,  -5.8496,
          0.0000,   0.0000,   0.0000,  15.8496,  10.0000,  10.0000,  10.0000,
          0.0000,   0.0000,   0.0000,  14.2884,   4.1504,  13.9855,  15.4057,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   6.4748,   6.9515,   5.4909,   5.6911,
          5.8496,   5.1457,   5.5254,   1.0000,   1.0000,   1.0000,   3.1316,
          0.0000, -28.0735, -28.0735,  -7.3697,   0.0000,  -8.7447,  -7.0044,
          0.0000, -10.0000, -10.0000,  -8.0735,   0.0000,   1.0000,   4.1504,
          0.0000,   0.0000,   0.0000, -10.0000,   0.0000,  10.0000,  10.0000,
          0.0000,   0.0000,   0.0000,   6.2597,   6.6610,   4.5457,   4.4594,
          6.0407,   8.3289,   9.3490,   7.5086,   8.1614,   1.0000,   4.1504,
          1.0000, -12.2239,  -6.7807,   6.1667,   3.8466,  15.8496,  14.8543,
        -25.8496,   0.0000,   0.0000,   1.0000,   1.0000,   0.0000,   7.3697,
        -23.2193,   0.0000,   0.0000,   1.0000,  10.0000,   0.0000,   1.0000,
        -15.8496,   0.0000,   0.0000,  11.2928,  13.2193,  11.1548,  15.0250,
          5.8496,   6.3743,   6.3743,  10.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   1.0000,  15.8496, -15.8496, -15.8496,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,  10.0000,   0.0000,  10.0000,  10.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   6.9216,  10.4231,   9.4837,  11.2928,
         10.5733,   1.0000,  12.6303, -10.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   5.8350,   5.8496,   5.3316,   5.3777,
         15.2725,   0.0000,   0.0000,   0.0000, -10.0000,   8.0735,  11.0269,
         11.1818,   0.0000,   0.0000,  21.1548,   1.0000,   7.4008,  18.2103,
         20.2975,   0.0000,   0.0000,  20.0000,  13.3880,   0.0000,   0.0000,
          3.0314,  10.0000,   0.0000,   0.0000, -10.0000, -10.0000,  14.5943,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,  21.1548,  17.3697,
         15.8496,  18.7447,  10.0000,   5.9548,   5.8129,   1.0000,   3.9855,
          7.3697,   1.0000,   1.0000,   1.0000,   5.6784,   4.2041,  11.1818,
          8.9308,   5.8496,   3.6678,   1.0000,   7.9355,  15.8496,   6.5208,
          1.0000,   5.4119,   5.2818,  10.8453,   0.0000,   6.5155,   5.5374,
          5.3937,   8.2685,   4.9750,   4.1504,   8.9308,  11.2553,  15.1457,
         15.8496,   3.7691,   3.0194,   9.1254,   6.8589, -10.0000,   6.5876,
          6.7406,   1.0000,   4.3211,   5.3727,   7.2437,   8.9052,   9.9187,
         12.4393,   7.5384,   4.8688,   5.7089,   4.5418,  15.4749,   6.3266,
         10.3747,   6.0768,   7.7761,  10.9954,   4.7131,   4.7414,   1.0000,
          5.3127,   7.0526,  18.0735,  19.6963,   7.0178,   6.2803,  22.4793,
         -6.2803,  -6.9515,  25.8496,   0.0000,   7.0044,   3.2193,   6.0898,
          1.0000,  25.8496,   3.2193,  25.0250,  10.0000,  14.5943,  13.0581,
         10.0000,  13.5050, -10.0000,   6.6104,  11.6993,   7.3947,  14.5943,
          6.9732,  14.2884,  17.2247,  26.2449,   0.0000,  14.5943,   0.0000,
         11.6993,  12.2239,  13.2193,   6.1934,   6.0266,  14.8239,   0.0000,
          6.6446,   3.0610,   1.0000,   8.5415,   8.3954,   6.1832,   5.8914,
          6.6158,   8.3825,   7.3550,   0.0000,   4.8543,   6.6498,   5.0119,
          1.0000,   8.9541,   5.2195,   6.3584,   5.3916,   5.8496,  25.4432,
         25.8496,  14.5943,  13.5050,   1.0000,  11.8442,  15.8496,  10.0000,
          1.0000,   0.0000,   9.6594,  14.0439,  18.0735,  15.3051,  14.1504,
          0.0000,   6.4757,  10.9954,   6.9622,  20.5889,  15.8496,  18.5798,
          8.2716,  10.9954,  20.0000,  15.8496,  12.2239, -10.0000,   6.7350,
         14.9476,   6.6297,   1.0000,  15.8496,   4.2939,   1.0000,  16.4770,
          6.5562,   3.8027,  23.2193,  12.8011,   7.3697,   6.9131,   6.5208,
         10.0000,   5.9864,   1.0000,  17.0782,  11.2553,   8.2368,  12.0163,
          4.2321,  12.2239,   6.9622,  12.7302,  17.1621,  17.3697,  21.6992,
         20.8746,   0.0000,   8.3007,  21.2928,  17.5899,   6.1508,  15.3605,
         25.8496,   3.7685,   6.4757,   4.7063,  26.6297,   7.4802,   6.7807,
          0.0000,   3.2193,  -6.2803,   4.0952,   1.0000,   9.5109,  15.8496,
         15.4057,  18.4800,   1.0000,   7.6994,   4.1093,   1.0000,   8.6412,
          6.8930,   3.3634,   5.8496,   4.7454,   9.2600,   1.0000,   8.7869,
          8.5704,   1.0000,   3.7529,  10.2667,  10.7595,   5.8496,   6.4584,
         13.0625,  18.7447,   9.4190,   6.5562,  10.0000,  24.1504,   5.8496,
          6.5042, -15.8496,   0.0000,   8.2597,   6.5153,   8.2415,   1.0000,
          1.0000,  11.6993,   5.4614,   6.3656,   1.0000,   3.8109,   5.0524,
          3.4945,   6.3743,   9.6467,  11.3465,   6.4584,   8.1407,   8.3335,
          9.6605,   5.8988,  15.8496,   6.4757,   6.6558,  12.9546,   4.8543,
         15.8496,   8.4800,   1.0000,  11.3750,   5.2921,   5.5420,   7.1989,
          6.3743,   3.3985,  11.6046,  11.4975,   6.3660,  10.4264,   7.9647,
          3.6678,   6.4584,   7.0941,   6.5896,   5.6096,   7.1272,   6.3743,
         15.1457,   8.3007,   5.2855,   8.1558,   4.6097,   5.0324,   4.7805,
         11.6993,   1.0000,   6.4235,   4.7854,   7.0526,   9.0689,  10.0000,
         13.4915,  17.4723,  22.8011,   8.4800,   0.0000,   8.5175,  21.6992,
          1.0000,  -4.8543,   7.0526,  10.4617,   6.4361,  23.2193,   6.2515,
          4.0551,   1.0000,   1.0000,   6.4746,   4.1265,   9.6605,   6.6957,
         13.9232,   5.7665,   4.7508,   4.3296,  13.2193,  15.8496,   7.1621,
          5.5124,  11.3750,  11.6993,   6.7094,   3.8702,   3.6189,   6.6558,
         16.4909,   1.0000,   6.5877,   8.2597,   1.0000,   1.0000,   6.5153,
          9.3226,   7.1989,   1.0000,   6.4361,   1.0000,  17.3697,  13.3065,
         12.8951,  15.8496,   6.7460,  17.3697,  14.1504,   6.4757,   6.5877,
          6.1964,   4.5943,   1.0000,   1.0000,   5.5472,   8.3140,   5.4432,
          5.5459,  -3.9232,   5.4349,   5.0295,   1.0000,   1.0000,   8.1222,
          5.4934,  -3.8333,   1.0000,   5.9676,   6.2344,   5.2556,   7.0745,
          4.9099,   1.0000,   1.0000,   6.2149,   8.3310,  12.8951,   6.7807,
          5.1457,   5.7925,   5.9864,   5.9864,   1.0000,   5.1096,  12.3704,
          1.0000,  14.1504,   3.2193,   6.1667,   1.0000,   1.0000,   5.8496,
          9.3289,  10.0000,  10.0000,   0.0000,  23.2193,  20.0000,  10.0000,
         20.0000,   4.5943,  20.0000,  10.0000,   0.0000,   0.0000,   4.5943,
          1.0000,  -8.0735,   8.6876,   1.0000,  23.2193,  11.6993,   1.0000,
          1.0000,   1.0000,  10.0000,  13.2193,  13.2193,   0.0000,   0.0000,
          1.0000,  23.2193,   0.0000,   7.3697,   0.0000,  20.0000,   3.7346,
          6.4853,  18.7447,   6.2449,  10.0000,  10.0000,   1.0000,   1.0000,
         10.0000,  12.2239,  10.0000,   0.0000,  19.2600,  -5.8496,   0.0000,
         10.0000,  14.1504,  15.8496,   3.2193,   0.0000,   0.0000,   6.4636,
          1.0000,  15.0250,   1.0000,   4.3610,   1.0000,   1.0000,   5.8496,
          6.3743,  10.0000,  10.0000,   0.0000,  23.2193,  20.0000,  10.0000,
         20.0000,   4.5943,  20.0000,   1.0000,   0.0000,   0.0000,   3.8995,
          1.0000,  -4.8543,   1.0000,   1.0000,  23.2193,   3.3703,   1.0000,
          1.0000,   1.0000,  10.0000,  13.2193,  13.2193,   0.0000,   0.0000,
          1.0000,  23.2193,   0.0000,   3.2193,   0.0000,  20.0000,   5.5254,
          6.1667,  20.0000,   4.1504,   6.7807,  10.0000,   1.0000,   1.0000,
          1.0000,   4.8543,  10.0000,   0.0000,  19.2600,  -5.8496,   0.0000,
         10.8746,  14.1504,  15.8496,   1.0000,   0.0000,   0.0000,   6.5208,
          6.5208,   0.0000, -15.8496,   0.0000,   0.0000, -10.0000,   0.0000,
         10.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   7.5207,
          7.5899,   0.0000,   1.0000,   0.0000,   0.0000,   1.0000,   0.0000,
        -23.2193,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   5.2154,
          6.1043,   5.3903,   3.6198,   1.0000,   1.0000,   1.0000,   1.0000,
          3.6946,   4.1918,   4.1093,   4.1918,   1.0000,   1.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,  25.2356,  25.8496,
         25.8496,  25.2356,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
         11.3750,  10.0000, -10.0000,  14.8543,   1.0000, -15.8496,  14.8543,
          5.1556,   1.0000,   0.0000,   5.3222,   6.6544,   5.8085,   7.0156,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   4.1093,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   6.7807,   4.3223,   4.4171,   1.0000,   5.2517,   4.2824,
          1.0000,   4.4424,   1.0000,   1.0000,   1.0000,   7.4574,   5.8914,
          3.7851,   7.0156,   4.7237,   4.5537,   5.3660,   3.6198,   6.1667,
          1.0000,   5.8085,   6.3743,   1.0000,   5.8203,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   3.6946,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   5.2154,   3.6198,   4.7237,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,  11.6993,
          0.0000,  13.0812,   0.0000,  13.5755,  13.5755,  11.6993,  11.4886,
          0.0000,   0.0000,   0.0000,   0.0000,   5.0822,   0.0000,   0.0000,
          0.0000,  12.7302,  10.0000,   1.0000,  10.0000,   5.8496,   5.8496,
          8.0735,   5.8496,   5.8496,   5.8496,   5.8496,   5.8496,   5.8496,
          5.8496,   6.7807,  11.3750,   5.8496,   6.7807,   5.8496,   5.8496,
          5.8496,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   3.7197,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   6.3743,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   5.9182,   6.2449,
          1.0000, -28.7447, -25.8496, -27.0044, -28.7447, -25.8496, -22.2239,
        -28.7447, -25.2356,   4.4057,   7.0044,   6.1891,   3.6257,   4.4057,
          5.5141, -27.0044,   1.0000,   1.0000,   1.0000,   1.0000,   1.0000,
          1.0000,   4.6234,   3.9689,   4.5638,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   1.0000,  -3.2193,  10.0000,
         -3.2193,  10.0000,  12.2239,  12.2239,  10.9954,   3.6257,   3.8598,
         10.0000,  12.2239,  13.0812,  12.2239,  12.2239,  15.8496,   5.9864,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   5.2517,   3.7197,   1.0000,   1.0000,   1.0000,
          1.0000,   1.0000,   4.4424,   3.1994,   4.2824,   0.0000,   0.0000,
          0.0000,  13.2193,  11.6993,  14.5943,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   8.6250,   0.0000,
          7.1049,   5.8496,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          6.4970,   0.0000,   0.0000,   6.7807,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   3.7197,   0.0000,   4.4746,   3.7440,   5.0175,
          5.9182,   5.9864,   6.3743,   3.2193,   1.0000,   4.9521,   5.8496,
          5.8496,   4.4057,   4.3223,   5.8496,   4.2824,   7.6553,   7.3290,
          3.1994,   0.0000,   5.0822,   4.4171,   5.6704,   1.0000,   3.4577,
          5.9182,   0.0000,   5.0175,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,  10.4947,   0.0000,   0.0000,   0.0000,   0.0000,   4.9521,
          3.9232,   5.7374,   1.0000,   1.0000,   1.0000,   3.5755,   8.0735,
          4.7393,   5.5254,   1.0000,   1.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,  12.8011,  15.1457,   8.9308,
         10.0000,  15.2725,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,  10.9954,   0.0000,   0.0000,  13.3880,
          1.0000,   3.0666,   3.7851,   5.3605,   3.2496,   1.0000,   1.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   1.0000,   0.0000,   0.0000,
          4.1143,   3.2650,   0.0000,   0.0000,   1.0000,   0.0000,   4.4424,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   5.9182,   0.0000,   1.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   6.0572,   1.0000,   1.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   1.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,  20.0000,   0.0000,  15.0250,   3.7851,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   1.0000,
          4.6467,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   6.6544,   5.1556,   0.0000,   0.0000,   0.0000,   5.9516,
          0.0000,   9.0536,   5.8887,   0.0000,   5.1457,   0.0000,   6.1667,
          7.1621,  10.0000,  15.8496,  14.7393,  24.5943,   0.0000,   0.0000,
         25.0250,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,  25.2356,
          0.0000,   0.0000,  12.2239,  11.6993,  15.8496,  13.4792,  17.0782,
          0.0000,   0.0000,  25.8496,   4.6467,   1.0000,   3.3800,   0.0000,
          0.0000,   0.0000,   1.0000,   1.0000,   1.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,  -5.4749,   1.0000,
          1.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   1.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          4.4746,   1.0000,   0.0000,   0.0000,   0.0000,   4.3223,   0.0000,
          0.0000,   0.0000,   1.0000,  13.0256,   1.0000,   1.0000,   7.0220,
         10.0000,   3.2193,   5.5639,   6.4970,   7.4919,   5.7495,   6.7807,
          0.0000,   4.8543,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   3.4042,   8.3650,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   3.7770,   5.5800,
         -3.2193, -28.7447, -28.7447,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   4.9521,   0.0000,   0.0000,   5.6704,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          1.0000,   0.0000,   0.0000,   0.0000,   1.0000,   0.0000,  -3.6613,
          3.1159,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   6.3743,   0.0000,   0.0000,   1.0000,   5.2793,
          1.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   4.8278,  17.0044,  21.2553,  17.6553,
         22.2239,  23.2193,  12.2239,  18.0735,  18.0735,   0.0000,  19.2600,
         15.8496,  17.0044,   0.0000,  18.4800,  18.0735,  24.5943,   0.0000,
          1.0000,   1.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   4.9521,   0.0000,
         -5.8496,   1.0000,   5.0779,   6.3743,   3.2193,   4.8810,   6.3387,
          5.1096,   3.8003,   8.4800,  10.0000,   1.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   1.0000,   3.2496,   4.5372,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   3.2862,   4.7491,   1.0000,
          0.0000,   0.0000,   3.1647,   3.7197,   0.0000,   0.0000,   5.8203,
          5.8496,  -3.3605,   1.0000,   1.0000,  -4.4931,  25.8496,   1.0000,
          1.0000,   1.0000,   1.0000,   0.0000,   0.0000,   0.0000,   5.8914,
          4.7237,   1.0000,   1.0000,   1.0000,   0.0000,   0.0000,   1.0000,
          0.0000,   3.8391,   4.5537,   1.0000,   0.0000,   1.0000,  15.4057,
         14.0210,  23.2193,  10.0000,  23.2193,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,  13.2193,   0.0000,   0.0000,   0.0000,
          1.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   5.0822,
          0.0000,   0.0000,   0.0000,   0.0000,   3.6198,   1.0000,   0.0000,
          0.0000,   0.0000,   1.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   3.7656,   4.1504,
         -3.3605,   0.0000,   3.7851,   0.0000,   0.0000,   4.4057,   0.0000,
         12.8293,  12.8293,   0.0000,   0.0000,   4.4424,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   7.3697,   0.0000,   9.8606,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   6.3077,   0.0000,
          6.3387,   0.0000,   5.5141,   0.0000,   0.0000,   0.0000,   4.3223,
          3.7440,   1.0000,   3.4577,   0.0000,   0.0000,   0.0000,   0.0000,
          5.3605,   7.2247,   5.8496,   1.0000,   1.0000,   8.0735,  11.3750,
          1.0000,   1.0000,   1.0000,   7.2247,   8.2597,   6.8806,   1.0000,
          5.5639,   8.3007,   1.0000,   7.1621,   1.0000,   1.0000,  -3.6565,
          1.0000,   8.9308,   5.2356,   8.3007,   7.1621,   7.7052,   1.0000,
          1.0000,   1.0000,   1.0000,  10.0000,   5.1457,   1.0000,   1.0000,
         12.2239,  20.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   1.0000,   0.0000, -10.0000, -10.0000, -10.0000,
        -10.0000,   5.8496,  10.0000,   0.0000,  11.6993,  10.0000,   0.0000,
          0.0000,   0.0000,   1.0000,   1.0000,   0.0000,   0.0000,   5.8496,
          0.0000,   0.0000,   1.0000,  -3.4792,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   5.3916, -11.2928,   5.1096,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,  23.2193,  27.0044,   0.0000,
          0.0000,   0.0000,   1.0000,  17.0044,   6.1934,   6.1369,   4.3769,
          5.7984,   5.4787,   5.9516,   5.8887,  12.0645,   8.0957,  15.2356,
          6.1369,   6.1934,  13.0933,  13.0256,  13.2193,   0.0000,   0.0000,
          0.0000,   0.0000,   3.1159,   5.2886,   5.7495,   0.0000,   0.0000,
          1.0000,   0.0000,   1.0000,   0.0000,   0.0000,   0.0000,   1.0000,
          0.0000,   0.0000,   0.0000,   6.6104,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   3.0666,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,  10.0000,  23.2193,   0.0000,   0.0000,   0.0000,
         10.0000,  23.2193,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000, -20.0000,   1.0000,   5.2793,
          1.0000,   7.4574,   4.4171,   1.0000,   1.0000, -18.0735, -23.2193,
        -20.0000,   1.0000, -20.0000,  -6.7807,   1.0000,   5.2517,   1.0000,
        -13.2193,  -3.1487, -29.0689, -29.0689, -27.0044, -11.3750,   0.0000,
          0.0000,   0.0000,  13.2193,   0.0000,   0.0000,   0.0000,   0.0000,
         11.6993,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000, -20.0000,  10.0000,  20.0000,  10.6193,  12.8011,   4.6467,
         28.0735,   0.0000,  28.0735,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   1.0000,   1.0000,   0.0000,   0.0000,   0.0000,
          1.0000,   6.7807,   5.9516,   0.0000,   6.7807,   0.0000,   6.1369,
          0.0000,   9.6047,   0.0000,   0.0000,   0.0000,   0.0000,   5.9516,
          0.0000,   6.5153,  10.5795,  13.0581,  10.5795,   1.0000,   0.0000,
         10.8746,   0.0000,  10.7800,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   6.4970,  15.8496,   8.2254,  15.8496,  15.8496,  10.0000,
          5.8496,  15.8496,  12.2239,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   4.3063,   9.2961,   0.0000,   1.0000,   1.0000,   0.0000,
          1.0000,   1.0000,   1.0000,   1.0000,   1.0000,   1.0000,   1.0000,
          0.0000,  11.6993,  11.6993,  10.7800,  11.4684,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          5.8496,   7.6553,   9.4342,   1.0000,  14.0718,   7.3697,   7.3230,
         13.0256,  20.0000,  11.5687,   7.3697,   6.7807,   5.9516,   5.8496,
          8.5845,   7.9992,  12.8293,   4.5943,  12.4393,   7.4582,   9.4342,
         13.8333,   1.0000,   5.8496,  10.0000,  10.0000,  10.0000,  10.0000,
         15.8496,  11.2776,   4.0255,   4.3440,   4.1079,   6.0823,   3.6067,
          8.2045,   1.0000,   1.0000,   1.0000,   1.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   4.0372,   1.0000,   1.0000,   1.0000,
         10.0000,   6.7807,   5.0589,   1.0000,   4.5638,   4.8543,   1.0000,
         10.0000,   8.9308,   4.7865,  14.1504,  15.8496,  17.7052,  12.0163,
         14.3296,  12.8011,   6.5896,  14.7393,  14.1504,   5.3660,   0.0000,
          4.5638,   4.7805,  15.3051,   6.8806,  13.4792,   5.9991,  12.6303,
          1.0000,  10.7800,   6.9515,   0.0000,   3.4994,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   5.9864,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   5.8496,   6.6297,
          5.4749,   1.0000,   1.0000,   1.0000,   5.4749,   1.0000,   7.2247,
          7.6184,   8.4800,   6.6297,   3.4514,   1.0000,   1.0000,   1.0000,
          1.0000,  11.6993,  10.0000,  10.0000,  12.2239,   7.6553,   6.1059,
          7.1425,  10.7400,   3.6067,   4.3610,   4.3296,   0.0000,   5.4749,
          1.0000,   1.0000,   3.7656,   1.0000,   1.0000,   1.0000,   1.0000,
          1.0000,   0.0000,   0.0000,   1.0000,   4.0372,   4.9185,   1.0000,
         10.4731,   4.6297,   6.2678,   1.0000,   7.1425,   0.0000,   1.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   6.1934,   1.0000,
         -3.6257,   1.0000,   1.0000,   1.0000,   3.8995,   1.0000,   0.0000,
          1.0000,   0.0000,   0.0000,   0.0000,   1.0000,  15.2356,   4.9354,
          5.4543,   7.8427,  10.5889,   1.0000,   8.0069,   0.0000,   5.7984,
          1.0000,   0.0000,   4.0255,  10.0000,  12.8011,  20.0000,   0.0000,
          0.0000,   1.0000,  23.2193,  14.1504,   3.5509,  11.8057,   5.9418,
          5.8038,  14.0718,  19.3289,   4.6234,   5.6188,   3.8995,  13.5050,
          5.4787,  13.8333,   8.9308,   9.0536,   5.8496,   0.0000,   0.0000,
          0.0000,   5.3343,   0.0000,   0.0000,   4.1504,   4.4980,   8.4800,
          1.0000,   1.0000,   8.2597,   4.0372,   4.7393,   1.0000,   1.0000,
          5.5639,   4.2824,  12.8293,  -4.8543,   3.9232,   1.0000,  -5.1457,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   1.0000,   0.0000,  -4.4931,  -8.2312,   4.8278,   6.8589,
          9.1030,   3.3909,   8.2532,   1.0000,   3.5776,   4.7865,   7.6553,
          4.2824,   0.0000,   6.2678,   3.1159,   0.0000,   0.0000,   0.0000,
          6.3743,   0.0000,   0.0000,   1.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,  13.0256,   0.0000,   0.0000,
         -3.2193,   0.0000,   1.0000,  -3.2193,   1.0000,   0.0000,   0.0000,
         -3.2193,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   5.8496,   0.0000,
          0.0000,   0.0000,   4.9033,   6.4386,   1.0000, -34.5943, -25.8496,
        -10.0000, -25.8496, -20.0000, -20.0000, -15.8496, -20.0000, -28.7447,
        -31.6992,   1.0000, -25.8496, -19.0689, -31.6992, -34.5943,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          5.8496,   1.0000,   6.9188,   3.7440,   1.0000,   5.8496,   1.0000,
          1.0000,  20.0000,   4.3123,   7.4474,  11.7585,   4.5785,   6.3743,
         10.0000,   1.0000,  13.2193,  18.7447,   7.7761,   5.0696,   0.0000,
         10.0000,   5.1457,   7.6553,  10.0000,  20.0000,  15.8496,  11.3750,
          7.0627,   5.4749,   3.3880,   1.0000,   1.0000, -10.0000,  10.0000,
         -5.8496,  10.0000,  10.0000,  10.0000,   5.3605, -10.0000,  -8.7447,
         10.0000,   5.4749,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   1.0000,   0.0000,   0.0000,   1.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   4.1504,   0.0000,   0.0000,   1.0000,
         10.0000,  10.0000,  10.0000,  10.0000,  10.0000,  10.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   5.8496,   6.2149,   1.0000,
          3.2193,   0.0000,   0.0000,   0.0000,   3.9232,  -4.8543,   1.0000,
          1.0000,   1.0000,   0.0000,   0.0000,   0.0000,   0.0000,  10.8746,
          0.0000,   0.0000,  15.8496,   0.0000,   0.0000,   0.0000,   4.1504,
          7.3697,  12.2239,   9.0046,  13.2193,   0.0000,   6.1005,   1.0000,
          0.0000,   1.0000,   0.0000,   0.0000,   3.9232,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          1.0000,   1.0000,   1.0000,   0.0000,   1.0000,   0.0000,   0.0000,
          0.0000,   8.3188,   5.3605,   4.1143,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   1.0000,   0.0000,   1.0000,   0.0000,   1.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   1.0000,   3.0666,   8.1359,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
        -22.2239, -22.2239,   0.0000, -28.7447, -19.0689, -28.0735,   0.0000,
          0.0000, -28.0735,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   5.8496,   0.0000,   0.0000,   0.0000,   5.8496,  10.0000,
          0.0000,  10.0000,  10.0000,  10.0000,   5.8496,   7.7412,   5.9516,
          3.3442,   5.2083,   4.6949,   5.3916,   6.6297,   7.8427,   8.6350,
         11.2928,   5.1211,   6.6838,   5.5639,   1.0000,  20.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,  19.4753,   4.1504,
          3.3817,   5.8496,  15.8496,   0.0000,   4.4057,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   5.2517,   0.0000,   0.0000,   0.0000,   0.0000,
          1.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
         13.2193,   0.0000,  20.0000,   0.0000,   0.0000,   1.0000,   1.0000,
         -3.6565,   6.9515,   6.9515,  -5.8496,   1.0000,   3.0933,   1.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   1.0000,   0.0000,
          1.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          1.0000,   0.0000,   0.0000,   1.0000,   1.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   4.7275,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,  15.8496,
         20.0000,  20.0000,  20.0000,  15.8496,   1.0000,   3.7281,   4.4626,
          1.0000,   3.2193,   1.0000,   0.0000,   1.0000,   4.6949,   7.0044,
          4.8543,   6.2149,   0.0000,   0.0000,   0.0000,   0.0000,   1.0000,
          1.0000,   0.0000,   0.0000,   0.0000,   3.7851,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,  15.2725,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   1.0000,   3.8702,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   3.2650,  10.0000,  21.6992,   5.1457,
          4.8063,   1.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          3.4994,  13.2193,  15.8496,  23.2193,   4.0054,   0.0000,   5.4432,
          1.0000,   8.0735,  -3.2193,   1.0000,  -4.4746,  10.0000,  10.0000,
          3.7197,  -4.1504,   0.0000,  16.4386,   7.3697,  13.0581,  16.9390,
         15.8496,   9.0046,   0.0000,   6.6985,   1.0000,   4.5519,   7.1049,
          8.0735,   5.3605,   8.7447,   8.0735,  15.1457,   1.0000,   4.5943,
          3.2193,   7.7761,   0.0000,   0.0000,   1.0000,   0.0000,   0.0000,
         14.8543,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   6.1005,   7.6553,  28.0735,
          5.8496,  18.0735,  18.0735,  13.2193,  28.0735,   3.2193,  10.7800,
         11.7585,   5.1556,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   5.9182,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   6.2149,   5.8496,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   1.0000,   4.5638,   0.0000,   7.0044,   0.0000,   6.2449,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          1.0000,   3.3258,   1.0000, -21.6992, -21.6992, -21.6992, -21.6992,
        -21.6992, -21.6992, -21.6992,   5.5102,  -3.2193,   1.0000,   1.0000,
          3.5364,   1.0000,   4.3610,   3.8414,   4.7644,   6.6297,   7.1621,
          1.0000,   1.0000,   1.0000,   1.0000,   6.9515,   1.0000,   4.4746,
          9.1427,   4.0781,   1.0000,   1.0000,   1.0000,   0.0000,   0.0000,
          1.0000,   0.0000,  10.0000,   1.0000, -12.2239,   1.0000,   1.0000,
          0.0000,   5.3853,   5.4176,   6.5153,   4.3769,   3.8995,   3.9232,
          6.5153,   6.2333,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,  15.8496,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,  -8.2716,   0.0000,
          0.0000,   0.0000,   5.8496,   0.0000,   0.0000,   0.0000,   0.0000,
         17.7052,   0.0000,  12.8011,   0.0000,  10.0000,   7.5002,   8.6673,
          6.2149,   6.9334,   8.4013,  14.1504,   5.8496,   6.4636,   5.8496,
          0.0000,   0.0000,   8.2597,   0.0000,   0.0000,   0.0000,  10.6193,
          1.0000,   0.0000,  10.0000,  10.0000,  20.0000,   3.5755,  20.0000,
          0.0000,   0.0000,   0.0000,   1.0000,   3.3258,   3.3015,   5.8496,
          1.0000,   4.3610,   9.4342,   0.0000,  -3.6613,  -9.0689,   0.0000,
          0.0000,   0.0000,   1.0000,   1.0000,   4.8278,   8.3007,   1.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   8.3007,   1.0000,   0.0000,
          3.8598,   0.0000,   0.0000,   4.2824,   0.0000,   0.0000,   0.0000,
          0.0000,   4.4057,  -3.3258,   0.0000,  -5.3605,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   6.1934,   0.0000,   8.2254,   0.0000,   0.0000,  13.0875,
          4.5638,   0.0000,   0.0000,   6.1369,   0.0000,   0.0000,   0.0000,
          1.0000,   0.0000,  13.2193,  14.5943,   6.3077,   6.7807,  12.2239,
          8.6250,   4.8810,   9.8606,  11.2928,  14.1504,  13.2193,  19.3491,
          6.6742,  13.2193,  10.0000,  23.2193,  21.6992,   3.2193,  13.7851,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
         15.8496,  13.0933,  15.0250,  13.0875,  13.2193,  15.8496,   0.0000,
          0.0000,  14.7393,   0.0000,  14.0210,  17.6553,  14.5943,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,  13.2193,  15.4057,
          8.0735,   0.0000,   0.0000,   1.0000,   1.0000,   6.1059,   0.0000,
          0.0000,   5.9401,   0.0000,   1.0000,   4.0054,   0.0000,   0.0000,
          0.0000,  -8.0735,   3.3800,   0.0000,   5.3903,   1.0000,   4.5537,
          0.0000,   0.0000,   9.0923,   7.0526,   8.2415,   8.4800,   0.0000,
          7.2247,   1.0000,   0.0000,   8.3007,   0.0000,   0.0000,   0.0000,
          0.0000,  12.8293,  16.7807,  15.2356,   5.0589,  14.1504,  14.0718,
         10.2857,  15.8496,  11.6993,   8.0735,   5.8496,  15.8496,  10.0000,
          1.0000,   3.2193,   7.4919,   4.9570,   5.5254,   5.6635,  14.8543,
         15.8496,   8.5190,   6.9188,   1.0000,   5.1983,   4.9957,   5.9516,
          5.8887,   6.5153,   5.0967,   5.8496,   5.4749,   4.3296,  12.4793,
          8.7447,   4.7865,   8.1714,   1.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   3.2193,   1.0000,   4.3063,   5.8203,
          1.0000,   7.0044,   5.8496,   1.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   5.8496,   0.0000,   0.0000,
         18.4800,   0.0000,   0.0000,   0.0000,  20.0000,   0.0000,   4.5638,
          1.0000,  -3.2193,   0.0000,   4.4057,   1.0000,   0.0000,   1.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,  12.2239,
          4.1504,   0.0000,   0.0000,   0.0000,   1.0000,   3.9855,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   1.0000,   0.0000,   0.0000,   0.0000,   1.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,   0.0000,
          0.0000,   4.7743,   5.2886,   4.6768,   5.8085,   6.9515,   1.0000,
          5.1245,   1.0000,   4.2489,  11.6993,  10.6711,   1.0000,   7.3697,
          1.0000])



class Chemical:
    def __init__(self, name, smiles, fp, toxicity):
        self.name = name
        self.smiles = smiles
        self.fp = fp
        self.toxicity = toxicity

    def __str__(self):
        return f"CHEMICAL {self.name} {self.smiles} : {self.toxicity} {self.fp}"

def read_files(rewrite_fp = False):
    if rewrite_fp:
        fingerprint_file = open("./data/fingerprint.csv").readlines()
    else:
        fingerprint_file = open("./data/full_fingerprint.csv").readlines()
    chemical_dict = dict()
    for line in fingerprint_file:
        content = line.split(',')
        chem_name = content[0].replace('"','')
        fp = [int(x) for x in list("".join(content[1:]).strip())]
        chemical_dict[chem_name] = Chemical(chem_name, "", fp, "")

    chemical_info = open("./data/smiles").readlines()
    for line in chemical_info:
        content = line.split(',')
        chem_name = content[0].replace('"','')
        smiles = content[1]
        toxicity = int(content[2].strip())
        chemical_dict[chem_name].smiles = smiles
        chemical_dict[chem_name].toxicity = toxicity
    if rewrite_fp:
        query_smiles = parse_input("./data/query_smiles")
        full_fp = open("./data/full_fingerprint.csv", 'w')
        count_match = 0
        itr = 1; total_chems = len(chemical_dict.values())
        for chemical in chemical_dict.values():
            m = Chem.MolFromSmiles(chemical.smiles, sanitize=False)
            for query_smile in query_smiles:
                query_mol = Chem.MolFromSmiles(query_smile, sanitize=False)
                b = 1 if m.HasSubstructMatch(query_mol) else 0
                count_match += b
                chemical.fp.append(b)
            full_fp.write(f'"{chemical.name}",{"".join([str(elem) for elem in chemical.fp])}\n')
            print(f"{itr}/{total_chems} processed, found {count_match}"); itr+=1
    return list(chemical_dict.values())

def read_aigen_file():
    query_smiles = parse_input("./data/query_smiles")
    count_match = 0
    f = open("./data/aigendrug_dili").readlines()
    chemical_dict = dict()
    idx = 0
    for line in f:
        content = line.split('	')[1:]
        chem_name = f"Aigen_{idx}"; idx += 1
        smiles = content[0].replace('"', '')
        toxicity = int(float(content[1].strip()))
        fp = []
        chem = Chem.MolFromSmiles(smiles, sanitize=False)
        for q in query_smiles:
            b = chem.HasSubstructMatch(Chem.MolFromSmiles(q, sanitize=False))
            b = int(b)
            count_match += b
            fp.append(b)
        chemical_dict[chem_name] = Chemical(name=chem_name, smiles=smiles, fp=fp, toxicity=toxicity)
        chemical_dict[chem_name].smiles = smiles
        chemical_dict[chem_name].toxicity = toxicity
    return list(chemical_dict.values())

class ChemicalDILIDataset(Dataset):
    def __init__(self, chem, use_torch_tensor = False, weight=None):
        self.chemicals = chem
        self.use_torch_tensor = use_torch_tensor
        self.weight = weight

    def __len__(self):
        return len(self.chemicals)

    def __getitem__(self, idx):
        if self.weight is not None :
            fp = np.array(self.chemicals[idx].fp) * self.weight 
            #fp = (fp - fp.min()) / (fp.max() - fp.min())
        else: fp = np.array(self.chemicals[idx].fp)
        tox = np.array([self.chemicals[idx].toxicity])
        if self.use_torch_tensor:
            fp = torch.Tensor(fp)
            tox = torch.Tensor(tox)
        return fp, tox

def load_DILI_data(weight=WEIGHT):
    chemicals = read_files()
    chem_train, chem_test = train_test_split(chemicals, test_size=0.1)
    train_set = ChemicalDILIDataset(chem_train, use_torch_tensor = True, weight = weight)
    test_set = ChemicalDILIDataset(chem_test, use_torch_tensor = True, weight = weight)
    train_loader = DataLoader(train_set, batch_size=1)
    test_loader = DataLoader(test_set)
    return train_loader, test_loader

def read_data_as_np(weight = None):
    chemicals = read_files()
    chem_train, chem_test = train_test_split(chemicals, test_size=0.2)
    train_set = ChemicalDILIDataset(chem_train, use_torch_tensor=False, weight=weight)
    test_set = ChemicalDILIDataset(chem_test, use_torch_tensor=False, weight=weight)
    return train_set, test_set
